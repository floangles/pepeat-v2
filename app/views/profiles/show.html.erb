
<% if @user.picture.nil? || @user.firstname.nil? || @user.lastname.nil? %>
  <div class="background-default window-height">
    <div class= "background-default-blur">
      <div class="background-default-blur-text">
        <h3 class= "text-center">Vous n'avez pas rempli votre profil</h3>
      </div>
      <div class="background-default-blur-edit">
        <%= link_to 'Je rempli mon profil', edit_profile_path, class: "btn btn-pepeat btn-lg" %>
      </div>
    </div>
  </div>
<% else %>

<div class="background-profile-show">
  <div class="background-profile-show-title">
    <h3>Votre profil</h3>
  </div>
</div>

<% if current_user.chief? %>
  <div class="container">
    <div class="chief-profile">
      <h1 class= "text-center profile-header">Mes informations</h1>
      <div class="row">
        <div class="col-xs-12 col-sm-6">
          <div class="chief-profile-left text-center">
            <h3>Ma photo de profil</h3>
            <div class= "classic-pic">
              <%= image_tag @user.picture.url(:large), id: "img-preview" %>
              <span class= "btn btn-danger crop"> Modifier ma photo</span>
            </div>
            <div class= "hidden-form cropable">
              <%= form_for @user, url: { action: "update", id: @user.id } do |f| %>
                <%= f.cropbox :picture, :width => 300 %>
                <div class= "text-center">
                  <%= f.submit 'Sauvegarder', class: "btn btn-pepeat" %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
        <div class="col-xs-12 col-sm-4 col-sm-offset-1">
          <div class="chief-profile-right text-center">
            <p> Nom de chef</p>
            <div class= "chief-profile-right-date">
              <%= @user.surname %>
            </div>
            <p> Prénom</p>
            <div class= "chief-profile-right-date">
              <%= @user.firstname %>
            </div>
            <p>Nom</p>
            <div class= "chief-profile-right-date">
              <%= @user.lastname %>
            </div>
            <p> Adresse</p>
            <div class= "chief-profile-right-date">
              <%= @user.address %>
            </div>
            <p> Numéro de téléphone</p>
            <div class= "chief-profile-right-date">
              <%= @user.phone_number %>
            </div>
            <p> Date de naissance</p>
            <div class= "chief-profile-right-date">
              <% if  @user.birth %>
                <%= l(@user.birth, format: '%d / %m / %Y') %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <div class= "chief-profile-submit">
        <%= link_to "Modifier mes informations", edit_profile_path, class: "btn-lg btn-pepeat" %>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="chief-description">
      <h1 class= "text-center profile-header">A propos de moi</h1>
      <div class="row">
        <div class="col-xs-12">
          <div class= "chief-description-picture">
            <%= image_tag @user.picture.url(:crop), class: "img-circle img-chef-meal" %>
            <div class= "chief-description-picture-fa">
              <i class="fa fa-comment fa-2x"></i>
            </div>
          </div>
           <p><%= @user.description.html_safe %></p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class= "stripe">
      <h1 class= "text-center profile-header">Mes informations bancaire</h1>
      <p class= "text-center">Pour assurer la sécurité des transferts vers votre compte nous passons par un service reconnu et spécialisé. Clicker sur le boutton et créer votre compte Stripe pour récupérer facielement votre argent. Cela ne vous prend que 3 minutes.</p>
      <div class= "text-center">
      <%= link_to image_tag('strip-connect.png'), user_omniauth_authorize_path(:stripe_connect) %>
      </div>
    </div>
  </div>

  <!-- create chiefpicture hidden form -->

  <div class= "hidden-form">
    <%= simple_form_for(@chief_picture, url: profile_chief_pictures_path, html: { multipart: true }) do |f| %>
      <%= f.error_notification %>
      <%= f.file_field :chiefpicture, id: "pictureInput"%>
      <%= f.button :submit, "GO!", id:"go", class: "btn-lg btn-danger" %>
    <% end %>
  </div>

  <!-- END create chiefpicture hidden form -->

  <div class="container">
    <div class="gallery-kitchen">
      <h1 class= "text-center profile-header">Ma gallerie photo</h1>
      <div class="row">
        <% @user.chief_pictures.each do |picture|%>
          <div class="col-xs-12 col-sm-3">
            <div class="picture-kitchen">
              <%= image_tag picture.chiefpicture.url(:large), class: "kitchen-size" %>
              <div class= "text-center">
                <%= link_to 'Redimensionner', croping_profile_path(picture), class: "button button-highlight button-tiny" %>
                <%= link_to profile_chief_picture_path(picture),
                method: :delete,
                data: { confirm: "Etes vous certain de vouloir supprimer la photo ?" } do %>
                <button class="button button-caution button-square button-tiny">
                <i class="fa fa-trash"></i>
                </button>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
        <div class= "col-xs-12 col-sm-3">
          <div id= "target3", class= "picture-kitchen">
            <%= image_tag 'placeholder.png', id: "placeholder", class: "kitchen-size" %>
          </div>
          <div id= 'target2'></div>
          <div class= "go-btn invisible" id= "space-btn">
            <%=link_to 'Je valide la photo', '#', class: 'btn btn-success' %>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="container">
    <div class="card-feedback">
      <h1 class= "text-center profile-header">Mes avis</h1>
      <div class="row">
        <% if review(@user) == 0 %>
            <h3 class= "text-center">Vous n'avez pas encore d'avis</h3>
        <% else %>
          <% @user.meals.each do |meal| %>
            <%= render '/shared/review', meal: meal %>
          <% end %>
          <div class= "text-center avis-btn-position">
            <%= link_to 'Voir tous les avis', rating_profile_path, class: "btn btn-pepeat" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% else %>

  <!-- no chief -->

  <div class="container">
      <div class="chief-profile">
        <h1 class= "text-center profile-header">Mes informations</h1>
        <div class="row">
          <div class="col-xs-6">
            <div class="chief-profile-left text-center">
              <h3>Ma photo de profil</h3>
              <%= image_tag @user.picture.url(:large), id: "img-preview" %>
            </div>
          </div>
          <div class="col-xs-4 col-xs-offset-1">
            <div class="chief-profile-right text-center">
              <p> Prénom</p>
              <div class= "chief-profile-right-date">
                <%= @user.firstname %>
              </div>
              <p>Nom</p>
              <div class= "chief-profile-right-date">
                <%= @user.lastname %>
              </div>
              <p> Numéro de téléphone</p>
              <div class= "chief-profile-right-date">
                <%= @user.phone_number %>
              </div>
              <p> Date de naissance</p>
              <div class= "chief-profile-right-date">
                <% if  @user.birth %>
                  <%= l(@user.birth, format: '%d / %m / %Y') %>
                <% end %>
              </div>
            </div>
          </div>
        </div>
        <div class= "chief-profile-submit">
          <%= link_to "Modifier mon profil", edit_profile_path, class: "btn-lg btn-pepeat" %>
        </div>
      </div>
    </div>
<% end %>


<style media="screen">
  .caca { background-image: url(<%= @user.picture.url(:medium) %>); }
</style>

<% end %>


